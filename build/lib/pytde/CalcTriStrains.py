''' 
This module is a near literal translation of the Matlab code provide 
by Brendan Meade.
'''
from __future__ import division
from numpy import (pi,cross,dot,sin,cos,tan,arctan2,
                   sqrt,array,asarray,zeros,empty)
from numpy.linalg import norm

def cot(x):
  return 1.0/tan(x)
  
def CalcTriStrains(sx, sy, sz, x, y, z, pr, ss, ts, ds):
  ''' 
  CalcTriStrains.py
  Calculates strains due to slip on a triangular dislocation in an
  elastic half space utilizing the symbolically differentiated
  displacement gradient tensor derived from the expressions for
  the displacements due to an angular dislocation in an elastic half
  space (Comninou and Dunders, 1975).

  Arguments
   sx : x-coordinates of observation points
   sy : y-coordinates of observation points
   sz : z-coordinates of observation points
   x  : x-coordinates of triangle vertices.
   y  : y-coordinates of triangle vertices.
   z  : z-coordinates of triangle vertices.
   pr : Poisson's ratio
   ss : strike slip displacement
   ts : tensile slip displacement
   ds : dip slip displacement
 
  Returns
   S  : structure containing the strains (S.xx, S.yy, S.zz, S.xy, S.xz, S.yz)
 
  This paper should and related code should be cited as:
  Brendan J. Meade, Algorithms for the calculation of exact 
  displacements, strains, and stresses for Triangular Dislocation 
  Elements in a uniform elastic half space, Computers & 
  Geosciences (2007), doi:10.1016/j.cageo.2006.12.003.
 
  Use at your own risk and please let me know of any bugs/errors.
 
  Copyright (c) 2006 Brendan Meade
  
  Permission is hereby granted, free of charge, to any person obtaining a
  copy of this software and associated documentation files (the
  "Software"), to deal in the Software without restriction, including
  without limitation the rights to use, copy, modify, merge, publish,
  distribute, sublicense, and/or sell copies of the Software, and to permit
  persons to whom the Software is furnished to do so, subject to the
  following conditions:
  
  The above copyright notice and this permission notice shall be included
  in all copies or substantial portions of the Software.
  
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
  OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
  NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
  DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
  OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
  USE OR OTHER DEALINGS IN THE SOFTWARE.
  '''
  sx = asarray(sx)
  sy = asarray(sy)
  sz = asarray(sz)
  x = asarray(x)
  y = asarray(y)
  z = asarray(z)
    
  # Calculate the slip vector in XYZ coordinates
  normVec = cross([x[1]-x[0],y[1]-y[0],z[1]-z[0]],
                  [x[2]-x[0],y[2]-y[0],z[2]-z[0]])
  normVec = normVec/norm(normVec)
  if (normVec[2] < 0): # Enforce clockwise circulation
    normVec = -normVec
    x[1],x[2] = swap(x[1],x[2])
    y[1],y[2] = swap(y[1],y[2])
    z[1],z[2] = swap(z[1],z[2])

  strikeVec = array([-sin(arctan2(normVec[1],normVec[0])), 
                      cos(arctan2(normVec[1], normVec[0])), 
                      0])
  dipVec = cross(normVec,strikeVec)
  slipVec = strikeVec*ss + dipVec*ds + normVec*ts

  # Solution vectors
  S = {}
  S['xx'] = zeros(sx.shape)
  S['yy'] = zeros(sx.shape)
  S['zz'] = zeros(sx.shape)
  S['xy'] = zeros(sx.shape)
  S['xz'] = zeros(sx.shape)
  S['yz'] = zeros(sx.shape)

  # Add a copy of the first vertex to the vertex list for indexing
  x = array([x[0],x[1],x[2],x[0]])
  y = array([y[0],y[1],y[2],y[0]])
  z = array([z[0],z[1],z[2],z[0]])

  for iTri in range(3):
    # Calculate strike and dip of current leg
    strike = 180/pi*(arctan2(y[iTri+1]-y[iTri],x[iTri+1]-x[iTri]))
    segMapLength = sqrt((x[iTri]-x[iTri+1])**2 + (y[iTri]-y[iTri+1])**2)
    rx,ry = RotateXyVec(x[iTri+1]-x[iTri],y[iTri+1]-y[iTri],-strike)
    dip = 180/pi*(arctan2(z[iTri+1]-z[iTri], rx))
   
    if dip >= 0:
      beta = pi/180*(90-dip)
      if beta > pi/2:
         beta = pi/2-beta

    else:
      beta = -pi/180*(90+dip)
      if beta < -pi/2:
         beta = pi/2-abs(beta)

    ssVec = array([cos(strike/180*pi),sin(strike/180*pi),0])
    tsVec = array([-sin(strike/180*pi),cos(strike/180*pi),0])
    dsVec = cross(ssVec, tsVec)
    lss = dot(slipVec,ssVec)
    lts = dot(slipVec,tsVec)
    lds = dot(slipVec,dsVec)

    if (abs(beta) > 0.000001) & (abs(beta-pi) > 0.000001):
      # First angular dislocation
      sx1,sy1 = RotateXyVec(sx-x[iTri], sy-y[iTri],-strike)
      a11,a22,a33,a12,a13,a23  = advs(sx1,sy1,sz-z[iTri],z[iTri],beta,pr,lss,lts,lds)
                                   
      # Second angular dislocation
      sx2,sy2 = RotateXyVec(sx-x[iTri+1],sy-y[iTri+1],-strike); 
      b11,b22,b33,b12,b13,b23 = advs(sx2,sy2,sz-z[iTri+1],z[iTri+1],beta,pr,lss,lts,lds)

      # Rotate tensors to correct for strike
      bxx = a11-b11
      byy = a22-b22
      bzz = a33-b33
      bxy = a12-b12
      bxz = a13-b13
      byz = a23-b23
      
      g = pi/180*strike;
      e11n = (cos(g)*bxx-sin(g)*bxy)*cos(g)-(cos(g)*bxy-sin(g)*byy)*sin(g)
      e12n = (cos(g)*bxx-sin(g)*bxy)*sin(g)+(cos(g)*bxy-sin(g)*byy)*cos(g)
      e13n = cos(g)*bxz-sin(g)*byz
      e22n = (sin(g)*bxx+cos(g)*bxy)*sin(g)+(sin(g)*bxy+cos(g)*byy)*cos(g)
      e23n = sin(g)*bxz+cos(g)*byz
      e33n = bzz
      
      # Add the strains from current leg
      S['xx'] = S['xx'] + e11n
      S['yy'] = S['yy'] + e22n
      S['zz'] = S['zz'] + e33n
      S['xy'] = S['xy'] + e12n
      S['xz'] = S['xz'] + e13n
      S['yz'] = S['yz'] + e23n

  return S

def swap(a,b):
  return b,a

def RotateXyVec(x,y,alpha):
  # Rotate a vector by an angle alpha
  alpha = pi/180*alpha
  xp = cos(alpha)*x - sin(alpha)*y
  yp = sin(alpha)*x + cos(alpha)*y
  return xp,yp

def advs(y1,y2,y3,a,b,nu,B1,B2,B3):
  # These are the strains in a uniform elastic half space due to slip
  # on an angular dislocation.  They were calculated by symbolically
  # differentiating the expressions for the displacements (Comninou and
  # Dunders, 1975, with typos noted by Thomas 1993) then combining the
  # elements of the displacement gradient tensor to form the strain tensor.
  sinb = sin(b)
  cosb = cos(b)
  tanb = tan(b)
  cotb = cot(b)
  y12 = y1**2
  y22 = y2**2
  y32 = y3**2
  y32a = y3+2*a
  y12y22y32 = y12+y22+y32
  y12y22y32a2 = y12+y22+y32a**2
  q = y12y22y32a2**(1/2)-y1*sinb+y32a*cosb
  r = y12y22y32a2**(1/2)+y32a
  v = y12y22y32a2**(1/2)
  z = y12y22y32**(1/2)
  
  e11 = B1*(1/8*((2-2*nu)*(2*y2/y12/(1+y22/y12)-y2/(y1*cosb-y3*sinb)**2*cosb/(1+y22/(y1*cosb-y3*sinb)**2)+(y2/z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)*y1-y2*z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2*(2*y1*cosb-y3*sinb))/(1+y22*(y12y22y32)*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2)-y2/(y1*cosb+(y32a)*sinb)**2*cosb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*y1-y2*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*(2*y1*cosb+(y32a)*sinb))/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))-y2*(1/z/(z-y3)+1/v/(r))-y1*y2*(-1/(y12y22y32)**(3/2)/(z-y3)*y1-1/(y12y22y32)/(z-y3)**2*y1-1/(y12y22y32a2)**(3/2)/(r)*y1-1/(y12y22y32a2)/(r)**2*y1)-y2*cosb*((1/z*sinb*y1-1)/z/(z-y1*sinb-y3*cosb)-(z*sinb-y1)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y1-(z*sinb-y1)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y1-sinb)+(1/v*sinb*y1-1)/v/(q)-(v*sinb-y1)/(y12y22y32a2)**(3/2)/(q)*y1-(v*sinb-y1)/v/(q)**2*(1/v*y1-sinb)))/pi/(1-nu)+1/4*((-2+2*nu)*(1-2*nu)*(y2/y12/(1+y22/y12)-y2/(y1*cosb+(y32a)*sinb)**2*cosb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*y1-y2*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*(2*y1*cosb+(y32a)*sinb))/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))*cotb**2-(1-2*nu)*y2/(r)**2*((1-2*nu-a/v)*cotb-y1/(r)*(nu+a/v))/v*y1+(1-2*nu)*y2/(r)*(a/(y12y22y32a2)**(3/2)*y1*cotb-1/(r)*(nu+a/v)+y12/(r)**2*(nu+a/v)/v+y12/(r)*a/(y12y22y32a2)**(3/2))-(1-2*nu)*y2*cosb*cotb/(q)**2*(cosb+a/v)*(1/v*y1-sinb)-(1-2*nu)*y2*cosb*cotb/(q)*a/(y12y22y32a2)**(3/2)*y1-3*a*y2*(y3+a)*cotb/(y12y22y32a2)**(5/2)*y1-y2*(y3+a)/(y12y22y32a2)**(3/2)/(r)*((-1+2*nu)*cotb+y1/(r)*(2*nu+a/v)+a*y1/(y12y22y32a2))*y1-y2*(y3+a)/(y12y22y32a2)/(r)**2*((-1+2*nu)*cotb+y1/(r)*(2*nu+a/v)+a*y1/(y12y22y32a2))*y1+y2*(y3+a)/v/(r)*(1/(r)*(2*nu+a/v)-y12/(r)**2*(2*nu+a/v)/v-y12/(r)*a/(y12y22y32a2)**(3/2)+a/(y12y22y32a2)-2*a*y12/(y12y22y32a2)**2)-y2*(y3+a)/(y12y22y32a2)**(3/2)/(q)*(cosb/(q)*((v*cosb+y32a)*((1-2*nu)*cosb-a/v)*cotb+(2-2*nu)*(v*sinb-y1)*cosb)-a*(y32a)*cosb*cotb/(y12y22y32a2))*y1-y2*(y3+a)/v/(q)**2*(cosb/(q)*((v*cosb+y32a)*((1-2*nu)*cosb-a/v)*cotb+(2-2*nu)*(v*sinb-y1)*cosb)-a*(y32a)*cosb*cotb/(y12y22y32a2))*(1/v*y1-sinb)+y2*(y3+a)/v/(q)*(-cosb/(q)**2*((v*cosb+y32a)*((1-2*nu)*cosb-a/v)*cotb+(2-2*nu)*(v*sinb-y1)*cosb)*(1/v*y1-sinb)+cosb/(q)*(1/v*cosb*y1*((1-2*nu)*cosb-a/v)*cotb+(v*cosb+y32a)*a/(y12y22y32a2)**(3/2)*y1*cotb+(2-2*nu)*(1/v*sinb*y1-1)*cosb)+2*a*(y32a)*cosb*cotb/(y12y22y32a2)**2*y1))/pi/(1-nu))+B2*(1/8*((-1+2*nu)*(1/z*y1/(z-y3)+1/v*y1/(r)-cosb*((1/z*y1-sinb)/(z-y1*sinb-y3*cosb)+(1/v*y1-sinb)/(q)))+2*y1*(1/z/(z-y3)+1/v/(r))+y12*(-1/(y12y22y32)**(3/2)/(z-y3)*y1-1/(y12y22y32)/(z-y3)**2*y1-1/(y12y22y32a2)**(3/2)/(r)*y1-1/(y12y22y32a2)/(r)**2*y1)+cosb*(z*sinb-y1)/z/(z-y1*sinb-y3*cosb)+(y1*cosb-y3*sinb)*(1/z*sinb*y1-1)/z/(z-y1*sinb-y3*cosb)-(y1*cosb-y3*sinb)*(z*sinb-y1)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y1-(y1*cosb-y3*sinb)*(z*sinb-y1)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y1-sinb)+cosb*(v*sinb-y1)/v/(q)+(y1*cosb+(y32a)*sinb)*(1/v*sinb*y1-1)/v/(q)-(y1*cosb+(y32a)*sinb)*(v*sinb-y1)/(y12y22y32a2)**(3/2)/(q)*y1-(y1*cosb+(y32a)*sinb)*(v*sinb-y1)/v/(q)**2*(1/v*y1-sinb))/pi/(1-nu)+1/4*((1-2*nu)*(((2-2*nu)*cotb**2+nu)/v*y1/(r)-((2-2*nu)*cotb**2+1)*cosb*(1/v*y1-sinb)/(q))-(1-2*nu)/(r)**2*((-1+2*nu)*y1*cotb+nu*(y32a)-a+a*y1*cotb/v+y12/(r)*(nu+a/v))/v*y1+(1-2*nu)/(r)*((-1+2*nu)*cotb+a*cotb/v-a*y12*cotb/(y12y22y32a2)**(3/2)+2*y1/(r)*(nu+a/v)-y1**3/(r)**2*(nu+a/v)/v-y1**3/(r)*a/(y12y22y32a2)**(3/2))+(1-2*nu)*cotb/(q)**2*((y1*cosb+(y32a)*sinb)*cosb-a*(v*sinb-y1)/v/cosb)*(1/v*y1-sinb)-(1-2*nu)*cotb/(q)*(cosb**2-a*(1/v*sinb*y1-1)/v/cosb+a*(v*sinb-y1)/(y12y22y32a2)**(3/2)/cosb*y1)-a*(y3+a)*cotb/(y12y22y32a2)**(3/2)+3*a*y12*(y3+a)*cotb/(y12y22y32a2)**(5/2)-(y3+a)/(r)**2*(2*nu+1/v*((1-2*nu)*y1*cotb+a)-y12/v/(r)*(2*nu+a/v)-a*y12/(y12y22y32a2)**(3/2))/v*y1+(y3+a)/(r)*(-1/(y12y22y32a2)**(3/2)*((1-2*nu)*y1*cotb+a)*y1+1/v*(1-2*nu)*cotb-2*y1/v/(r)*(2*nu+a/v)+y1**3/(y12y22y32a2)**(3/2)/(r)*(2*nu+a/v)+y1**3/(y12y22y32a2)/(r)**2*(2*nu+a/v)+y1**3/(y12y22y32a2)**2/(r)*a-2*a/(y12y22y32a2)**(3/2)*y1+3*a*y1**3/(y12y22y32a2)**(5/2))-(y3+a)*cotb/(q)**2*(-cosb*sinb+a*y1*(y32a)/(y12y22y32a2)**(3/2)/cosb+(v*sinb-y1)/v*((2-2*nu)*cosb-(v*cosb+y32a)/(q)*(1+a/v/cosb)))*(1/v*y1-sinb)+(y3+a)*cotb/(q)*(a*(y32a)/(y12y22y32a2)**(3/2)/cosb-3*a*y12*(y32a)/(y12y22y32a2)**(5/2)/cosb+(1/v*sinb*y1-1)/v*((2-2*nu)*cosb-(v*cosb+y32a)/(q)*(1+a/v/cosb))-(v*sinb-y1)/(y12y22y32a2)**(3/2)*((2-2*nu)*cosb-(v*cosb+y32a)/(q)*(1+a/v/cosb))*y1+(v*sinb-y1)/v*(-1/v*cosb*y1/(q)*(1+a/v/cosb)+(v*cosb+y32a)/(q)**2*(1+a/v/cosb)*(1/v*y1-sinb)+(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)/cosb*y1)))/pi/(1-nu))+B3*(1/8*y2*sinb*((1/z*sinb*y1-1)/z/(z-y1*sinb-y3*cosb)-(z*sinb-y1)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y1-(z*sinb-y1)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y1-sinb)+(1/v*sinb*y1-1)/v/(q)-(v*sinb-y1)/(y12y22y32a2)**(3/2)/(q)*y1-(v*sinb-y1)/v/(q)**2*(1/v*y1-sinb))/pi/(1-nu)+1/4*((1-2*nu)*(-y2/(r)**2*(1+a/v)/v*y1-y2/(r)*a/(y12y22y32a2)**(3/2)*y1+y2*cosb/(q)**2*(cosb+a/v)*(1/v*y1-sinb)+y2*cosb/(q)*a/(y12y22y32a2)**(3/2)*y1)+y2*(y3+a)/(y12y22y32a2)**(3/2)*(a/(y12y22y32a2)+1/(r))*y1-y2*(y3+a)/v*(-2*a/(y12y22y32a2)**2*y1-1/(r)**2/v*y1)-y2*(y3+a)*cosb/(y12y22y32a2)**(3/2)/(q)*((v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))*y1-y2*(y3+a)*cosb/v/(q)**2*((v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))*(1/v*y1-sinb)+y2*(y3+a)*cosb/v/(q)*(1/v*cosb*y1/(q)*(cosb+a/v)-(v*cosb+y32a)/(q)**2*(cosb+a/v)*(1/v*y1-sinb)-(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)*y1-2*a*(y32a)/(y12y22y32a2)**2*y1))/pi/(1-nu))
  e22 = B1*(1/8*((1-2*nu)*(1/z*y2/(z-y3)+1/v*y2/(r)-cosb*(1/z*y2/(z-y1*sinb-y3*cosb)+1/v*y2/(q)))-2*y2*(1/z/(z-y3)+1/v/(r)-cosb*(1/z/(z-y1*sinb-y3*cosb)+1/v/(q)))-y22*(-1/(y12y22y32)**(3/2)/(z-y3)*y2-1/(y12y22y32)/(z-y3)**2*y2-1/(y12y22y32a2)**(3/2)/(r)*y2-1/(y12y22y32a2)/(r)**2*y2-cosb*(-1/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y2-1/(y12y22y32)/(z-y1*sinb-y3*cosb)**2*y2-1/(y12y22y32a2)**(3/2)/(q)*y2-1/(y12y22y32a2)/(q)**2*y2)))/pi/(1-nu)+1/4*((1-2*nu)*(((2-2*nu)*cotb**2-nu)/v*y2/(r)-((2-2*nu)*cotb**2+1-2*nu)*cosb/v*y2/(q))+(1-2*nu)/(r)**2*(y1*cotb*(1-2*nu-a/v)+nu*(y32a)-a+y22/(r)*(nu+a/v))/v*y2-(1-2*nu)/(r)*(a*y1*cotb/(y12y22y32a2)**(3/2)*y2+2*y2/(r)*(nu+a/v)-y2**3/(r)**2*(nu+a/v)/v-y2**3/(r)*a/(y12y22y32a2)**(3/2))+(1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb/(q)**2*(cosb+a/v)/v*y2+(1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb/(q)*a/(y12y22y32a2)**(3/2)*y2+3*a*y2*(y3+a)*cotb/(y12y22y32a2)**(5/2)*y1-(y3+a)/(r)**2*(-2*nu+1/v*((1-2*nu)*y1*cotb-a)+y22/v/(r)*(2*nu+a/v)+a*y22/(y12y22y32a2)**(3/2))/v*y2+(y3+a)/(r)*(-1/(y12y22y32a2)**(3/2)*((1-2*nu)*y1*cotb-a)*y2+2*y2/v/(r)*(2*nu+a/v)-y2**3/(y12y22y32a2)**(3/2)/(r)*(2*nu+a/v)-y2**3/(y12y22y32a2)/(r)**2*(2*nu+a/v)-y2**3/(y12y22y32a2)**2/(r)*a+2*a/(y12y22y32a2)**(3/2)*y2-3*a*y2**3/(y12y22y32a2)**(5/2))-(y3+a)/(q)**2*(cosb**2-1/v*((1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb+a*cosb)+a*(y32a)*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)**(3/2)-1/v/(q)*(y22*cosb**2-a*(y1*cosb+(y32a)*sinb)*cotb/v*(v*cosb+y32a)))/v*y2+(y3+a)/(q)*(1/(y12y22y32a2)**(3/2)*((1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb+a*cosb)*y2-3*a*(y32a)*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)**(5/2)*y2+1/(y12y22y32a2)**(3/2)/(q)*(y22*cosb**2-a*(y1*cosb+(y32a)*sinb)*cotb/v*(v*cosb+y32a))*y2+1/(y12y22y32a2)/(q)**2*(y22*cosb**2-a*(y1*cosb+(y32a)*sinb)*cotb/v*(v*cosb+y32a))*y2-1/v/(q)*(2*y2*cosb**2+a*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)**(3/2)*(v*cosb+y32a)*y2-a*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)*cosb*y2)))/pi/(1-nu))+B2*(1/8*((2-2*nu)*(-2/y1/(1+y22/y12)+1/(y1*cosb-y3*sinb)/(1+y22/(y1*cosb-y3*sinb)**2)+(z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)+y22/z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)-2*y22*z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2*cosb)/(1+y22*(y12y22y32)*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2)+1/(y1*cosb+(y32a)*sinb)/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)+y22/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)-2*y22*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*cosb)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))+y1*(1/z/(z-y3)+1/v/(r))+y1*y2*(-1/(y12y22y32)**(3/2)/(z-y3)*y2-1/(y12y22y32)/(z-y3)**2*y2-1/(y12y22y32a2)**(3/2)/(r)*y2-1/(y12y22y32a2)/(r)**2*y2)-(y1*cosb-y3*sinb)/z/(z-y1*sinb-y3*cosb)-(y1*cosb+(y32a)*sinb)/v/(q)-y2*(-(y1*cosb-y3*sinb)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y2-(y1*cosb-y3*sinb)/(y12y22y32)/(z-y1*sinb-y3*cosb)**2*y2-(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**(3/2)/(q)*y2-(y1*cosb+(y32a)*sinb)/(y12y22y32a2)/(q)**2*y2))/pi/(1-nu)+1/4*((2-2*nu)*(1-2*nu)*(-1/y1/(1+y22/y12)+1/(y1*cosb+(y32a)*sinb)/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)+y22/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)-2*y22*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*cosb)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))*cotb**2+(1-2*nu)/(r)*((-1+2*nu+a/v)*cotb+y1/(r)*(nu+a/v))-(1-2*nu)*y22/(r)**2*((-1+2*nu+a/v)*cotb+y1/(r)*(nu+a/v))/v+(1-2*nu)*y2/(r)*(-a/(y12y22y32a2)**(3/2)*y2*cotb-y1/(r)**2*(nu+a/v)/v*y2-y2/(r)*a/(y12y22y32a2)**(3/2)*y1)-(1-2*nu)*cotb/(q)*(1+a/v/cosb)+(1-2*nu)*y22*cotb/(q)**2*(1+a/v/cosb)/v+(1-2*nu)*y22*cotb/(q)*a/(y12y22y32a2)**(3/2)/cosb-a*(y3+a)*cotb/(y12y22y32a2)**(3/2)+3*a*y22*(y3+a)*cotb/(y12y22y32a2)**(5/2)+(y3+a)/v/(r)*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/v*(1/v+1/(r)))-y22*(y3+a)/(y12y22y32a2)**(3/2)/(r)*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/v*(1/v+1/(r)))-y22*(y3+a)/(y12y22y32a2)/(r)**2*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/v*(1/v+1/(r)))+y2*(y3+a)/v/(r)*(2*nu*y1/(r)**2/v*y2+a*y1/(y12y22y32a2)**(3/2)*(1/v+1/(r))*y2-a*y1/v*(-1/(y12y22y32a2)**(3/2)*y2-1/(r)**2/v*y2))+(y3+a)*cotb/v/(q)*((-2+2*nu)*cosb+(v*cosb+y32a)/(q)*(1+a/v/cosb)+a*(y32a)/(y12y22y32a2)/cosb)-y22*(y3+a)*cotb/(y12y22y32a2)**(3/2)/(q)*((-2+2*nu)*cosb+(v*cosb+y32a)/(q)*(1+a/v/cosb)+a*(y32a)/(y12y22y32a2)/cosb)-y22*(y3+a)*cotb/(y12y22y32a2)/(q)**2*((-2+2*nu)*cosb+(v*cosb+y32a)/(q)*(1+a/v/cosb)+a*(y32a)/(y12y22y32a2)/cosb)+y2*(y3+a)*cotb/v/(q)*(1/v*cosb*y2/(q)*(1+a/v/cosb)-(v*cosb+y32a)/(q)**2*(1+a/v/cosb)/v*y2-(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)/cosb*y2-2*a*(y32a)/(y12y22y32a2)**2/cosb*y2))/pi/(1-nu))+B3*(1/8*((1-2*nu)*sinb*(1/z*y2/(z-y1*sinb-y3*cosb)+1/v*y2/(q))-2*y2*sinb*(1/z/(z-y1*sinb-y3*cosb)+1/v/(q))-y22*sinb*(-1/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y2-1/(y12y22y32)/(z-y1*sinb-y3*cosb)**2*y2-1/(y12y22y32a2)**(3/2)/(q)*y2-1/(y12y22y32a2)/(q)**2*y2))/pi/(1-nu)+1/4*((1-2*nu)*(-sinb/v*y2/(q)+y2/(r)**2*(1+a/v)/v*y1+y2/(r)*a/(y12y22y32a2)**(3/2)*y1-(y1*cosb+(y32a)*sinb)/(q)**2*(cosb+a/v)/v*y2-(y1*cosb+(y32a)*sinb)/(q)*a/(y12y22y32a2)**(3/2)*y2)-y2*(y3+a)/(y12y22y32a2)**(3/2)*(a/(y12y22y32a2)+1/(r))*y1+y1*(y3+a)/v*(-2*a/(y12y22y32a2)**2*y2-1/(r)**2/v*y2)+(y3+a)/(q)**2*(sinb*(cosb-a/v)+(y1*cosb+(y32a)*sinb)/v*(1+a*(y32a)/(y12y22y32a2))-1/v/(q)*(y22*cosb*sinb-a*(y1*cosb+(y32a)*sinb)/v*(v*cosb+y32a)))/v*y2-(y3+a)/(q)*(sinb*a/(y12y22y32a2)**(3/2)*y2-(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**(3/2)*(1+a*(y32a)/(y12y22y32a2))*y2-2*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**(5/2)*a*(y32a)*y2+1/(y12y22y32a2)**(3/2)/(q)*(y22*cosb*sinb-a*(y1*cosb+(y32a)*sinb)/v*(v*cosb+y32a))*y2+1/(y12y22y32a2)/(q)**2*(y22*cosb*sinb-a*(y1*cosb+(y32a)*sinb)/v*(v*cosb+y32a))*y2-1/v/(q)*(2*y2*cosb*sinb+a*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**(3/2)*(v*cosb+y32a)*y2-a*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)*cosb*y2)))/pi/(1-nu))
  e33 = B1*(1/8*y2*(-1/(y12y22y32)**(3/2)*y3+1/2/(y12y22y32a2)**(3/2)*(2*y3+4*a)-cosb*((1/z*cosb*y3-1)/z/(z-y1*sinb-y3*cosb)-(z*cosb-y3)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y3-(z*cosb-y3)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y3-cosb)-(1/2/v*cosb*(2*y3+4*a)+1)/v/(q)+1/2*(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*(2*y3+4*a)+(v*cosb+y32a)/v/(q)**2*(1/2/v*(2*y3+4*a)+cosb)))/pi/(1-nu)+1/4*((2-2*nu)*((1-2*nu)*(-y2/(y1*cosb+(y32a)*sinb)**2*sinb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(1/2*y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*(2*y3+4*a)-y2*v*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*y1)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))*cotb-y2/(r)**2*(2*nu+a/v)*(1/2/v*(2*y3+4*a)+1)-1/2*y2/(r)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)+y2*cosb/(q)**2*(cosb+a/v)*(1/2/v*(2*y3+4*a)+cosb)+1/2*y2*cosb/(q)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a))+y2/v*(2*nu/(r)+a/(y12y22y32a2))-1/2*y2*(y3+a)/(y12y22y32a2)**(3/2)*(2*nu/(r)+a/(y12y22y32a2))*(2*y3+4*a)+y2*(y3+a)/v*(-2*nu/(r)**2*(1/2/v*(2*y3+4*a)+1)-a/(y12y22y32a2)**2*(2*y3+4*a))+y2*cosb/v/(q)*(1-2*nu-(v*cosb+y32a)/(q)*(cosb+a/v)-a*(y32a)/(y12y22y32a2))-1/2*y2*(y3+a)*cosb/(y12y22y32a2)**(3/2)/(q)*(1-2*nu-(v*cosb+y32a)/(q)*(cosb+a/v)-a*(y32a)/(y12y22y32a2))*(2*y3+4*a)-y2*(y3+a)*cosb/v/(q)**2*(1-2*nu-(v*cosb+y32a)/(q)*(cosb+a/v)-a*(y32a)/(y12y22y32a2))*(1/2/v*(2*y3+4*a)+cosb)+y2*(y3+a)*cosb/v/(q)*(-(1/2/v*cosb*(2*y3+4*a)+1)/(q)*(cosb+a/v)+(v*cosb+y32a)/(q)**2*(cosb+a/v)*(1/2/v*(2*y3+4*a)+cosb)+1/2*(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)-a/(y12y22y32a2)+a*(y32a)/(y12y22y32a2)**2*(2*y3+4*a)))/pi/(1-nu))+B2*(1/8*((-1+2*nu)*sinb*((1/z*y3-cosb)/(z-y1*sinb-y3*cosb)-(1/2/v*(2*y3+4*a)+cosb)/(q))-y1*(-1/(y12y22y32)**(3/2)*y3+1/2/(y12y22y32a2)**(3/2)*(2*y3+4*a))-sinb*(z*cosb-y3)/z/(z-y1*sinb-y3*cosb)+(y1*cosb-y3*sinb)*(1/z*cosb*y3-1)/z/(z-y1*sinb-y3*cosb)-(y1*cosb-y3*sinb)*(z*cosb-y3)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y3-(y1*cosb-y3*sinb)*(z*cosb-y3)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y3-cosb)-sinb*(v*cosb+y32a)/v/(q)-(y1*cosb+(y32a)*sinb)*(1/2/v*cosb*(2*y3+4*a)+1)/v/(q)+1/2*(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*(2*y3+4*a)+(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/v/(q)**2*(1/2/v*(2*y3+4*a)+cosb))/pi/(1-nu)+1/4*((-2+2*nu)*(1-2*nu)*cotb*((1/2/v*(2*y3+4*a)+1)/(r)-cosb*(1/2/v*(2*y3+4*a)+cosb)/(q))+(2-2*nu)*y1/(r)**2*(2*nu+a/v)*(1/2/v*(2*y3+4*a)+1)+1/2*(2-2*nu)*y1/(r)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)+(2-2*nu)*sinb/(q)*(cosb+a/v)-(2-2*nu)*(y1*cosb+(y32a)*sinb)/(q)**2*(cosb+a/v)*(1/2/v*(2*y3+4*a)+cosb)-1/2*(2-2*nu)*(y1*cosb+(y32a)*sinb)/(q)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)+1/v*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/(y12y22y32a2))-1/2*(y3+a)/(y12y22y32a2)**(3/2)*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/(y12y22y32a2))*(2*y3+4*a)+(y3+a)/v*(2*nu*y1/(r)**2*(1/2/v*(2*y3+4*a)+1)+a*y1/(y12y22y32a2)**2*(2*y3+4*a))-1/(q)*(cosb*sinb+(v*cosb+y32a)*cotb/v*((2-2*nu)*cosb-(v*cosb+y32a)/(q))+a/v*(sinb-(y32a)*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)-(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/v/(q)))+(y3+a)/(q)**2*(cosb*sinb+(v*cosb+y32a)*cotb/v*((2-2*nu)*cosb-(v*cosb+y32a)/(q))+a/v*(sinb-(y32a)*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)-(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/v/(q)))*(1/2/v*(2*y3+4*a)+cosb)-(y3+a)/(q)*((1/2/v*cosb*(2*y3+4*a)+1)*cotb/v*((2-2*nu)*cosb-(v*cosb+y32a)/(q))-1/2*(v*cosb+y32a)*cotb/(y12y22y32a2)**(3/2)*((2-2*nu)*cosb-(v*cosb+y32a)/(q))*(2*y3+4*a)+(v*cosb+y32a)*cotb/v*(-(1/2/v*cosb*(2*y3+4*a)+1)/(q)+(v*cosb+y32a)/(q)**2*(1/2/v*(2*y3+4*a)+cosb))-1/2*a/(y12y22y32a2)**(3/2)*(sinb-(y32a)*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)-(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/v/(q))*(2*y3+4*a)+a/v*(-(y1*cosb+(y32a)*sinb)/(y12y22y32a2)-(y32a)*sinb/(y12y22y32a2)+(y32a)*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**2*(2*y3+4*a)-sinb*(v*cosb+y32a)/v/(q)-(y1*cosb+(y32a)*sinb)*(1/2/v*cosb*(2*y3+4*a)+1)/v/(q)+1/2*(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*(2*y3+4*a)+(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/v/(q)**2*(1/2/v*(2*y3+4*a)+cosb))))/pi/(1-nu))+B3*(1/8*((2-2*nu)*(y2/(y1*cosb-y3*sinb)**2*sinb/(1+y22/(y1*cosb-y3*sinb)**2)+(y2/z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)*y3+y2*z*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2*y1)/(1+y22*(y12y22y32)*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2)+y2/(y1*cosb+(y32a)*sinb)**2*sinb/(1+y22/(y1*cosb+(y32a)*sinb)**2)-(1/2*y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*(2*y3+4*a)-y2*v*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*y1)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))+y2*sinb*((1/z*cosb*y3-1)/z/(z-y1*sinb-y3*cosb)-(z*cosb-y3)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y3-(z*cosb-y3)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y3-cosb)-(1/2/v*cosb*(2*y3+4*a)+1)/v/(q)+1/2*(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*(2*y3+4*a)+(v*cosb+y32a)/v/(q)**2*(1/2/v*(2*y3+4*a)+cosb)))/pi/(1-nu)+1/4*((2-2*nu)*(-y2/(y1*cosb+(y32a)*sinb)**2*sinb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(1/2*y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*(2*y3+4*a)-y2*v*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*y1)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))-(2-2*nu)*y2*sinb/(q)**2*(cosb+a/v)*(1/2/v*(2*y3+4*a)+cosb)-1/2*(2-2*nu)*y2*sinb/(q)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)+y2*sinb/v/(q)*(1+(v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))-1/2*y2*(y3+a)*sinb/(y12y22y32a2)**(3/2)/(q)*(1+(v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))*(2*y3+4*a)-y2*(y3+a)*sinb/v/(q)**2*(1+(v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))*(1/2/v*(2*y3+4*a)+cosb)+y2*(y3+a)*sinb/v/(q)*((1/2/v*cosb*(2*y3+4*a)+1)/(q)*(cosb+a/v)-(v*cosb+y32a)/(q)**2*(cosb+a/v)*(1/2/v*(2*y3+4*a)+cosb)-1/2*(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)+a/(y12y22y32a2)-a*(y32a)/(y12y22y32a2)**2*(2*y3+4*a)))/pi/(1-nu))
  e12 = 1/2*B1*(1/8*((2-2*nu)*(-2/y1/(1+y22/y12)+1/(y1*cosb-y3*sinb)/(1+y22/(y1*cosb-y3*sinb)**2)+(z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)+y22/z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)-2*y22*z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2*cosb)/(1+y22*(y12y22y32)*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2)+1/(y1*cosb+(y32a)*sinb)/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)+y22/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)-2*y22*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*cosb)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))-y1*(1/z/(z-y3)+1/v/(r))-y1*y2*(-1/(y12y22y32)**(3/2)/(z-y3)*y2-1/(y12y22y32)/(z-y3)**2*y2-1/(y12y22y32a2)**(3/2)/(r)*y2-1/(y12y22y32a2)/(r)**2*y2)-cosb*((z*sinb-y1)/z/(z-y1*sinb-y3*cosb)+(v*sinb-y1)/v/(q))-y2*cosb*(1/(y12y22y32)*sinb*y2/(z-y1*sinb-y3*cosb)-(z*sinb-y1)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y2-(z*sinb-y1)/(y12y22y32)/(z-y1*sinb-y3*cosb)**2*y2+1/(y12y22y32a2)*sinb*y2/(q)-(v*sinb-y1)/(y12y22y32a2)**(3/2)/(q)*y2-(v*sinb-y1)/(y12y22y32a2)/(q)**2*y2))/pi/(1-nu)+1/4*((-2+2*nu)*(1-2*nu)*(-1/y1/(1+y22/y12)+1/(y1*cosb+(y32a)*sinb)/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)+y22/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)-2*y22*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*cosb)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))*cotb**2+(1-2*nu)/(r)*((1-2*nu-a/v)*cotb-y1/(r)*(nu+a/v))-(1-2*nu)*y22/(r)**2*((1-2*nu-a/v)*cotb-y1/(r)*(nu+a/v))/v+(1-2*nu)*y2/(r)*(a/(y12y22y32a2)**(3/2)*y2*cotb+y1/(r)**2*(nu+a/v)/v*y2+y2/(r)*a/(y12y22y32a2)**(3/2)*y1)+(1-2*nu)*cosb*cotb/(q)*(cosb+a/v)-(1-2*nu)*y22*cosb*cotb/(q)**2*(cosb+a/v)/v-(1-2*nu)*y22*cosb*cotb/(q)*a/(y12y22y32a2)**(3/2)+a*(y3+a)*cotb/(y12y22y32a2)**(3/2)-3*a*y22*(y3+a)*cotb/(y12y22y32a2)**(5/2)+(y3+a)/v/(r)*((-1+2*nu)*cotb+y1/(r)*(2*nu+a/v)+a*y1/(y12y22y32a2))-y22*(y3+a)/(y12y22y32a2)**(3/2)/(r)*((-1+2*nu)*cotb+y1/(r)*(2*nu+a/v)+a*y1/(y12y22y32a2))-y22*(y3+a)/(y12y22y32a2)/(r)**2*((-1+2*nu)*cotb+y1/(r)*(2*nu+a/v)+a*y1/(y12y22y32a2))+y2*(y3+a)/v/(r)*(-y1/(r)**2*(2*nu+a/v)/v*y2-y2/(r)*a/(y12y22y32a2)**(3/2)*y1-2*a*y1/(y12y22y32a2)**2*y2)+(y3+a)/v/(q)*(cosb/(q)*((v*cosb+y32a)*((1-2*nu)*cosb-a/v)*cotb+(2-2*nu)*(v*sinb-y1)*cosb)-a*(y32a)*cosb*cotb/(y12y22y32a2))-y22*(y3+a)/(y12y22y32a2)**(3/2)/(q)*(cosb/(q)*((v*cosb+y32a)*((1-2*nu)*cosb-a/v)*cotb+(2-2*nu)*(v*sinb-y1)*cosb)-a*(y32a)*cosb*cotb/(y12y22y32a2))-y22*(y3+a)/(y12y22y32a2)/(q)**2*(cosb/(q)*((v*cosb+y32a)*((1-2*nu)*cosb-a/v)*cotb+(2-2*nu)*(v*sinb-y1)*cosb)-a*(y32a)*cosb*cotb/(y12y22y32a2))+y2*(y3+a)/v/(q)*(-cosb/(q)**2*((v*cosb+y32a)*((1-2*nu)*cosb-a/v)*cotb+(2-2*nu)*(v*sinb-y1)*cosb)/v*y2+cosb/(q)*(1/v*cosb*y2*((1-2*nu)*cosb-a/v)*cotb+(v*cosb+y32a)*a/(y12y22y32a2)**(3/2)*y2*cotb+(2-2*nu)/v*sinb*y2*cosb)+2*a*(y32a)*cosb*cotb/(y12y22y32a2)**2*y2))/pi/(1-nu))+1/2*B2*(1/8*((-1+2*nu)*(1/z*y2/(z-y3)+1/v*y2/(r)-cosb*(1/z*y2/(z-y1*sinb-y3*cosb)+1/v*y2/(q)))+y12*(-1/(y12y22y32)**(3/2)/(z-y3)*y2-1/(y12y22y32)/(z-y3)**2*y2-1/(y12y22y32a2)**(3/2)/(r)*y2-1/(y12y22y32a2)/(r)**2*y2)+(y1*cosb-y3*sinb)/(y12y22y32)*sinb*y2/(z-y1*sinb-y3*cosb)-(y1*cosb-y3*sinb)*(z*sinb-y1)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y2-(y1*cosb-y3*sinb)*(z*sinb-y1)/(y12y22y32)/(z-y1*sinb-y3*cosb)**2*y2+(y1*cosb+(y32a)*sinb)/(y12y22y32a2)*sinb*y2/(q)-(y1*cosb+(y32a)*sinb)*(v*sinb-y1)/(y12y22y32a2)**(3/2)/(q)*y2-(y1*cosb+(y32a)*sinb)*(v*sinb-y1)/(y12y22y32a2)/(q)**2*y2)/pi/(1-nu)+1/4*((1-2*nu)*(((2-2*nu)*cotb**2+nu)/v*y2/(r)-((2-2*nu)*cotb**2+1)*cosb/v*y2/(q))-(1-2*nu)/(r)**2*((-1+2*nu)*y1*cotb+nu*(y32a)-a+a*y1*cotb/v+y12/(r)*(nu+a/v))/v*y2+(1-2*nu)/(r)*(-a*y1*cotb/(y12y22y32a2)**(3/2)*y2-y12/(r)**2*(nu+a/v)/v*y2-y12/(r)*a/(y12y22y32a2)**(3/2)*y2)+(1-2*nu)*cotb/(q)**2*((y1*cosb+(y32a)*sinb)*cosb-a*(v*sinb-y1)/v/cosb)/v*y2-(1-2*nu)*cotb/(q)*(-a/(y12y22y32a2)*sinb*y2/cosb+a*(v*sinb-y1)/(y12y22y32a2)**(3/2)/cosb*y2)+3*a*y2*(y3+a)*cotb/(y12y22y32a2)**(5/2)*y1-(y3+a)/(r)**2*(2*nu+1/v*((1-2*nu)*y1*cotb+a)-y12/v/(r)*(2*nu+a/v)-a*y12/(y12y22y32a2)**(3/2))/v*y2+(y3+a)/(r)*(-1/(y12y22y32a2)**(3/2)*((1-2*nu)*y1*cotb+a)*y2+y12/(y12y22y32a2)**(3/2)/(r)*(2*nu+a/v)*y2+y12/(y12y22y32a2)/(r)**2*(2*nu+a/v)*y2+y12/(y12y22y32a2)**2/(r)*a*y2+3*a*y12/(y12y22y32a2)**(5/2)*y2)-(y3+a)*cotb/(q)**2*(-cosb*sinb+a*y1*(y32a)/(y12y22y32a2)**(3/2)/cosb+(v*sinb-y1)/v*((2-2*nu)*cosb-(v*cosb+y32a)/(q)*(1+a/v/cosb)))/v*y2+(y3+a)*cotb/(q)*(-3*a*y1*(y32a)/(y12y22y32a2)**(5/2)/cosb*y2+1/(y12y22y32a2)*sinb*y2*((2-2*nu)*cosb-(v*cosb+y32a)/(q)*(1+a/v/cosb))-(v*sinb-y1)/(y12y22y32a2)**(3/2)*((2-2*nu)*cosb-(v*cosb+y32a)/(q)*(1+a/v/cosb))*y2+(v*sinb-y1)/v*(-1/v*cosb*y2/(q)*(1+a/v/cosb)+(v*cosb+y32a)/(q)**2*(1+a/v/cosb)/v*y2+(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)/cosb*y2)))/pi/(1-nu))+1/2*B3*(1/8*sinb*((z*sinb-y1)/z/(z-y1*sinb-y3*cosb)+(v*sinb-y1)/v/(q))/pi/(1-nu)+1/8*y2*sinb*(1/(y12y22y32)*sinb*y2/(z-y1*sinb-y3*cosb)-(z*sinb-y1)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y2-(z*sinb-y1)/(y12y22y32)/(z-y1*sinb-y3*cosb)**2*y2+1/(y12y22y32a2)*sinb*y2/(q)-(v*sinb-y1)/(y12y22y32a2)**(3/2)/(q)*y2-(v*sinb-y1)/(y12y22y32a2)/(q)**2*y2)/pi/(1-nu)+1/4*((1-2*nu)*(1/(r)*(1+a/v)-y22/(r)**2*(1+a/v)/v-y22/(r)*a/(y12y22y32a2)**(3/2)-cosb/(q)*(cosb+a/v)+y22*cosb/(q)**2*(cosb+a/v)/v+y22*cosb/(q)*a/(y12y22y32a2)**(3/2))-(y3+a)/v*(a/(y12y22y32a2)+1/(r))+y22*(y3+a)/(y12y22y32a2)**(3/2)*(a/(y12y22y32a2)+1/(r))-y2*(y3+a)/v*(-2*a/(y12y22y32a2)**2*y2-1/(r)**2/v*y2)+(y3+a)*cosb/v/(q)*((v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))-y22*(y3+a)*cosb/(y12y22y32a2)**(3/2)/(q)*((v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))-y22*(y3+a)*cosb/(y12y22y32a2)/(q)**2*((v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))+y2*(y3+a)*cosb/v/(q)*(1/v*cosb*y2/(q)*(cosb+a/v)-(v*cosb+y32a)/(q)**2*(cosb+a/v)/v*y2-(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)*y2-2*a*(y32a)/(y12y22y32a2)**2*y2))/pi/(1-nu))+1/2*B1*(1/8*((1-2*nu)*(1/z*y1/(z-y3)+1/v*y1/(r)-cosb*((1/z*y1-sinb)/(z-y1*sinb-y3*cosb)+(1/v*y1-sinb)/(q)))-y22*(-1/(y12y22y32)**(3/2)/(z-y3)*y1-1/(y12y22y32)/(z-y3)**2*y1-1/(y12y22y32a2)**(3/2)/(r)*y1-1/(y12y22y32a2)/(r)**2*y1-cosb*(-1/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y1-1/z/(z-y1*sinb-y3*cosb)**2*(1/z*y1-sinb)-1/(y12y22y32a2)**(3/2)/(q)*y1-1/v/(q)**2*(1/v*y1-sinb))))/pi/(1-nu)+1/4*((1-2*nu)*(((2-2*nu)*cotb**2-nu)/v*y1/(r)-((2-2*nu)*cotb**2+1-2*nu)*cosb*(1/v*y1-sinb)/(q))+(1-2*nu)/(r)**2*(y1*cotb*(1-2*nu-a/v)+nu*(y32a)-a+y22/(r)*(nu+a/v))/v*y1-(1-2*nu)/(r)*((1-2*nu-a/v)*cotb+a*y12*cotb/(y12y22y32a2)**(3/2)-y22/(r)**2*(nu+a/v)/v*y1-y22/(r)*a/(y12y22y32a2)**(3/2)*y1)-(1-2*nu)*cosb*cotb/(q)*(cosb+a/v)+(1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb/(q)**2*(cosb+a/v)*(1/v*y1-sinb)+(1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb/(q)*a/(y12y22y32a2)**(3/2)*y1-a*(y3+a)*cotb/(y12y22y32a2)**(3/2)+3*a*y12*(y3+a)*cotb/(y12y22y32a2)**(5/2)-(y3+a)/(r)**2*(-2*nu+1/v*((1-2*nu)*y1*cotb-a)+y22/v/(r)*(2*nu+a/v)+a*y22/(y12y22y32a2)**(3/2))/v*y1+(y3+a)/(r)*(-1/(y12y22y32a2)**(3/2)*((1-2*nu)*y1*cotb-a)*y1+1/v*(1-2*nu)*cotb-y22/(y12y22y32a2)**(3/2)/(r)*(2*nu+a/v)*y1-y22/(y12y22y32a2)/(r)**2*(2*nu+a/v)*y1-y22/(y12y22y32a2)**2/(r)*a*y1-3*a*y22/(y12y22y32a2)**(5/2)*y1)-(y3+a)/(q)**2*(cosb**2-1/v*((1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb+a*cosb)+a*(y32a)*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)**(3/2)-1/v/(q)*(y22*cosb**2-a*(y1*cosb+(y32a)*sinb)*cotb/v*(v*cosb+y32a)))*(1/v*y1-sinb)+(y3+a)/(q)*(1/(y12y22y32a2)**(3/2)*((1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb+a*cosb)*y1-1/v*(1-2*nu)*cosb*cotb+a*(y32a)*cosb*cotb/(y12y22y32a2)**(3/2)-3*a*(y32a)*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)**(5/2)*y1+1/(y12y22y32a2)**(3/2)/(q)*(y22*cosb**2-a*(y1*cosb+(y32a)*sinb)*cotb/v*(v*cosb+y32a))*y1+1/v/(q)**2*(y22*cosb**2-a*(y1*cosb+(y32a)*sinb)*cotb/v*(v*cosb+y32a))*(1/v*y1-sinb)-1/v/(q)*(-a*cosb*cotb/v*(v*cosb+y32a)+a*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)**(3/2)*(v*cosb+y32a)*y1-a*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)*cosb*y1)))/pi/(1-nu))+1/2*B2*(1/8*((2-2*nu)*(2*y2/y12/(1+y22/y12)-y2/(y1*cosb-y3*sinb)**2*cosb/(1+y22/(y1*cosb-y3*sinb)**2)+(y2/z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)*y1-y2*z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2*(2*y1*cosb-y3*sinb))/(1+y22*(y12y22y32)*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2)-y2/(y1*cosb+(y32a)*sinb)**2*cosb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*y1-y2*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*(2*y1*cosb+(y32a)*sinb))/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))+y2*(1/z/(z-y3)+1/v/(r))+y1*y2*(-1/(y12y22y32)**(3/2)/(z-y3)*y1-1/(y12y22y32)/(z-y3)**2*y1-1/(y12y22y32a2)**(3/2)/(r)*y1-1/(y12y22y32a2)/(r)**2*y1)-y2*(cosb/z/(z-y1*sinb-y3*cosb)-(y1*cosb-y3*sinb)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y1-(y1*cosb-y3*sinb)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y1-sinb)+cosb/v/(q)-(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**(3/2)/(q)*y1-(y1*cosb+(y32a)*sinb)/v/(q)**2*(1/v*y1-sinb)))/pi/(1-nu)+1/4*((2-2*nu)*(1-2*nu)*(y2/y12/(1+y22/y12)-y2/(y1*cosb+(y32a)*sinb)**2*cosb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*y1-y2*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*(2*y1*cosb+(y32a)*sinb))/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))*cotb**2-(1-2*nu)*y2/(r)**2*((-1+2*nu+a/v)*cotb+y1/(r)*(nu+a/v))/v*y1+(1-2*nu)*y2/(r)*(-a/(y12y22y32a2)**(3/2)*y1*cotb+1/(r)*(nu+a/v)-y12/(r)**2*(nu+a/v)/v-y12/(r)*a/(y12y22y32a2)**(3/2))+(1-2*nu)*y2*cotb/(q)**2*(1+a/v/cosb)*(1/v*y1-sinb)+(1-2*nu)*y2*cotb/(q)*a/(y12y22y32a2)**(3/2)/cosb*y1+3*a*y2*(y3+a)*cotb/(y12y22y32a2)**(5/2)*y1-y2*(y3+a)/(y12y22y32a2)**(3/2)/(r)*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/v*(1/v+1/(r)))*y1-y2*(y3+a)/(y12y22y32a2)/(r)**2*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/v*(1/v+1/(r)))*y1+y2*(y3+a)/v/(r)*(-2*nu/(r)+2*nu*y12/(r)**2/v-a/v*(1/v+1/(r))+a*y12/(y12y22y32a2)**(3/2)*(1/v+1/(r))-a*y1/v*(-1/(y12y22y32a2)**(3/2)*y1-1/(r)**2/v*y1))-y2*(y3+a)*cotb/(y12y22y32a2)**(3/2)/(q)*((-2+2*nu)*cosb+(v*cosb+y32a)/(q)*(1+a/v/cosb)+a*(y32a)/(y12y22y32a2)/cosb)*y1-y2*(y3+a)*cotb/v/(q)**2*((-2+2*nu)*cosb+(v*cosb+y32a)/(q)*(1+a/v/cosb)+a*(y32a)/(y12y22y32a2)/cosb)*(1/v*y1-sinb)+y2*(y3+a)*cotb/v/(q)*(1/v*cosb*y1/(q)*(1+a/v/cosb)-(v*cosb+y32a)/(q)**2*(1+a/v/cosb)*(1/v*y1-sinb)-(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)/cosb*y1-2*a*(y32a)/(y12y22y32a2)**2/cosb*y1))/pi/(1-nu))+1/2*B3*(1/8*((1-2*nu)*sinb*((1/z*y1-sinb)/(z-y1*sinb-y3*cosb)+(1/v*y1-sinb)/(q))-y22*sinb*(-1/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y1-1/z/(z-y1*sinb-y3*cosb)**2*(1/z*y1-sinb)-1/(y12y22y32a2)**(3/2)/(q)*y1-1/v/(q)**2*(1/v*y1-sinb)))/pi/(1-nu)+1/4*((1-2*nu)*(-sinb*(1/v*y1-sinb)/(q)-1/(r)*(1+a/v)+y12/(r)**2*(1+a/v)/v+y12/(r)*a/(y12y22y32a2)**(3/2)+cosb/(q)*(cosb+a/v)-(y1*cosb+(y32a)*sinb)/(q)**2*(cosb+a/v)*(1/v*y1-sinb)-(y1*cosb+(y32a)*sinb)/(q)*a/(y12y22y32a2)**(3/2)*y1)+(y3+a)/v*(a/(y12y22y32a2)+1/(r))-y12*(y3+a)/(y12y22y32a2)**(3/2)*(a/(y12y22y32a2)+1/(r))+y1*(y3+a)/v*(-2*a/(y12y22y32a2)**2*y1-1/(r)**2/v*y1)+(y3+a)/(q)**2*(sinb*(cosb-a/v)+(y1*cosb+(y32a)*sinb)/v*(1+a*(y32a)/(y12y22y32a2))-1/v/(q)*(y22*cosb*sinb-a*(y1*cosb+(y32a)*sinb)/v*(v*cosb+y32a)))*(1/v*y1-sinb)-(y3+a)/(q)*(sinb*a/(y12y22y32a2)**(3/2)*y1+cosb/v*(1+a*(y32a)/(y12y22y32a2))-(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**(3/2)*(1+a*(y32a)/(y12y22y32a2))*y1-2*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**(5/2)*a*(y32a)*y1+1/(y12y22y32a2)**(3/2)/(q)*(y22*cosb*sinb-a*(y1*cosb+(y32a)*sinb)/v*(v*cosb+y32a))*y1+1/v/(q)**2*(y22*cosb*sinb-a*(y1*cosb+(y32a)*sinb)/v*(v*cosb+y32a))*(1/v*y1-sinb)-1/v/(q)*(-a*cosb/v*(v*cosb+y32a)+a*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**(3/2)*(v*cosb+y32a)*y1-a*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)*cosb*y1)))/pi/(1-nu))
  e13 = 1/2*B1*(1/8*((2-2*nu)*(y2/(y1*cosb-y3*sinb)**2*sinb/(1+y22/(y1*cosb-y3*sinb)**2)+(y2/z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)*y3+y2*z*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2*y1)/(1+y22*(y12y22y32)*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2)-y2/(y1*cosb+(y32a)*sinb)**2*sinb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(1/2*y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*(2*y3+4*a)-y2*v*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*y1)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))-y1*y2*(-1/(y12y22y32)**(3/2)/(z-y3)*y3-1/z/(z-y3)**2*(1/z*y3-1)-1/2/(y12y22y32a2)**(3/2)/(r)*(2*y3+4*a)-1/v/(r)**2*(1/2/v*(2*y3+4*a)+1))-y2*cosb*(1/(y12y22y32)*sinb*y3/(z-y1*sinb-y3*cosb)-(z*sinb-y1)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y3-(z*sinb-y1)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y3-cosb)+1/2/(y12y22y32a2)*sinb*(2*y3+4*a)/(q)-1/2*(v*sinb-y1)/(y12y22y32a2)**(3/2)/(q)*(2*y3+4*a)-(v*sinb-y1)/v/(q)**2*(1/2/v*(2*y3+4*a)+cosb)))/pi/(1-nu)+1/4*((-2+2*nu)*(1-2*nu)*(-y2/(y1*cosb+(y32a)*sinb)**2*sinb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(1/2*y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*(2*y3+4*a)-y2*v*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*y1)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))*cotb**2-(1-2*nu)*y2/(r)**2*((1-2*nu-a/v)*cotb-y1/(r)*(nu+a/v))*(1/2/v*(2*y3+4*a)+1)+(1-2*nu)*y2/(r)*(1/2*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)*cotb+y1/(r)**2*(nu+a/v)*(1/2/v*(2*y3+4*a)+1)+1/2*y1/(r)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a))-(1-2*nu)*y2*cosb*cotb/(q)**2*(cosb+a/v)*(1/2/v*(2*y3+4*a)+cosb)-1/2*(1-2*nu)*y2*cosb*cotb/(q)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)+a/(y12y22y32a2)**(3/2)*y2*cotb-3/2*a*y2*(y3+a)*cotb/(y12y22y32a2)**(5/2)*(2*y3+4*a)+y2/v/(r)*((-1+2*nu)*cotb+y1/(r)*(2*nu+a/v)+a*y1/(y12y22y32a2))-1/2*y2*(y3+a)/(y12y22y32a2)**(3/2)/(r)*((-1+2*nu)*cotb+y1/(r)*(2*nu+a/v)+a*y1/(y12y22y32a2))*(2*y3+4*a)-y2*(y3+a)/v/(r)**2*((-1+2*nu)*cotb+y1/(r)*(2*nu+a/v)+a*y1/(y12y22y32a2))*(1/2/v*(2*y3+4*a)+1)+y2*(y3+a)/v/(r)*(-y1/(r)**2*(2*nu+a/v)*(1/2/v*(2*y3+4*a)+1)-1/2*y1/(r)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)-a*y1/(y12y22y32a2)**2*(2*y3+4*a))+y2/v/(q)*(cosb/(q)*((v*cosb+y32a)*((1-2*nu)*cosb-a/v)*cotb+(2-2*nu)*(v*sinb-y1)*cosb)-a*(y32a)*cosb*cotb/(y12y22y32a2))-1/2*y2*(y3+a)/(y12y22y32a2)**(3/2)/(q)*(cosb/(q)*((v*cosb+y32a)*((1-2*nu)*cosb-a/v)*cotb+(2-2*nu)*(v*sinb-y1)*cosb)-a*(y32a)*cosb*cotb/(y12y22y32a2))*(2*y3+4*a)-y2*(y3+a)/v/(q)**2*(cosb/(q)*((v*cosb+y32a)*((1-2*nu)*cosb-a/v)*cotb+(2-2*nu)*(v*sinb-y1)*cosb)-a*(y32a)*cosb*cotb/(y12y22y32a2))*(1/2/v*(2*y3+4*a)+cosb)+y2*(y3+a)/v/(q)*(-cosb/(q)**2*((v*cosb+y32a)*((1-2*nu)*cosb-a/v)*cotb+(2-2*nu)*(v*sinb-y1)*cosb)*(1/2/v*(2*y3+4*a)+cosb)+cosb/(q)*((1/2/v*cosb*(2*y3+4*a)+1)*((1-2*nu)*cosb-a/v)*cotb+1/2*(v*cosb+y32a)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)*cotb+1/2*(2-2*nu)/v*sinb*(2*y3+4*a)*cosb)-a*cosb*cotb/(y12y22y32a2)+a*(y32a)*cosb*cotb/(y12y22y32a2)**2*(2*y3+4*a)))/pi/(1-nu))+1/2*B2*(1/8*((-1+2*nu)*((1/z*y3-1)/(z-y3)+(1/2/v*(2*y3+4*a)+1)/(r)-cosb*((1/z*y3-cosb)/(z-y1*sinb-y3*cosb)+(1/2/v*(2*y3+4*a)+cosb)/(q)))+y12*(-1/(y12y22y32)**(3/2)/(z-y3)*y3-1/z/(z-y3)**2*(1/z*y3-1)-1/2/(y12y22y32a2)**(3/2)/(r)*(2*y3+4*a)-1/v/(r)**2*(1/2/v*(2*y3+4*a)+1))-sinb*(z*sinb-y1)/z/(z-y1*sinb-y3*cosb)+(y1*cosb-y3*sinb)/(y12y22y32)*sinb*y3/(z-y1*sinb-y3*cosb)-(y1*cosb-y3*sinb)*(z*sinb-y1)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y3-(y1*cosb-y3*sinb)*(z*sinb-y1)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y3-cosb)+sinb*(v*sinb-y1)/v/(q)+1/2*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)*sinb*(2*y3+4*a)/(q)-1/2*(y1*cosb+(y32a)*sinb)*(v*sinb-y1)/(y12y22y32a2)**(3/2)/(q)*(2*y3+4*a)-(y1*cosb+(y32a)*sinb)*(v*sinb-y1)/v/(q)**2*(1/2/v*(2*y3+4*a)+cosb))/pi/(1-nu)+1/4*((1-2*nu)*(((2-2*nu)*cotb**2+nu)*(1/2/v*(2*y3+4*a)+1)/(r)-((2-2*nu)*cotb**2+1)*cosb*(1/2/v*(2*y3+4*a)+cosb)/(q))-(1-2*nu)/(r)**2*((-1+2*nu)*y1*cotb+nu*(y32a)-a+a*y1*cotb/v+y12/(r)*(nu+a/v))*(1/2/v*(2*y3+4*a)+1)+(1-2*nu)/(r)*(nu-1/2*a*y1*cotb/(y12y22y32a2)**(3/2)*(2*y3+4*a)-y12/(r)**2*(nu+a/v)*(1/2/v*(2*y3+4*a)+1)-1/2*y12/(r)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a))+(1-2*nu)*cotb/(q)**2*((y1*cosb+(y32a)*sinb)*cosb-a*(v*sinb-y1)/v/cosb)*(1/2/v*(2*y3+4*a)+cosb)-(1-2*nu)*cotb/(q)*(cosb*sinb-1/2*a/(y12y22y32a2)*sinb*(2*y3+4*a)/cosb+1/2*a*(v*sinb-y1)/(y12y22y32a2)**(3/2)/cosb*(2*y3+4*a))-a/(y12y22y32a2)**(3/2)*y1*cotb+3/2*a*y1*(y3+a)*cotb/(y12y22y32a2)**(5/2)*(2*y3+4*a)+1/(r)*(2*nu+1/v*((1-2*nu)*y1*cotb+a)-y12/v/(r)*(2*nu+a/v)-a*y12/(y12y22y32a2)**(3/2))-(y3+a)/(r)**2*(2*nu+1/v*((1-2*nu)*y1*cotb+a)-y12/v/(r)*(2*nu+a/v)-a*y12/(y12y22y32a2)**(3/2))*(1/2/v*(2*y3+4*a)+1)+(y3+a)/(r)*(-1/2/(y12y22y32a2)**(3/2)*((1-2*nu)*y1*cotb+a)*(2*y3+4*a)+1/2*y12/(y12y22y32a2)**(3/2)/(r)*(2*nu+a/v)*(2*y3+4*a)+y12/v/(r)**2*(2*nu+a/v)*(1/2/v*(2*y3+4*a)+1)+1/2*y12/(y12y22y32a2)**2/(r)*a*(2*y3+4*a)+3/2*a*y12/(y12y22y32a2)**(5/2)*(2*y3+4*a))+cotb/(q)*(-cosb*sinb+a*y1*(y32a)/(y12y22y32a2)**(3/2)/cosb+(v*sinb-y1)/v*((2-2*nu)*cosb-(v*cosb+y32a)/(q)*(1+a/v/cosb)))-(y3+a)*cotb/(q)**2*(-cosb*sinb+a*y1*(y32a)/(y12y22y32a2)**(3/2)/cosb+(v*sinb-y1)/v*((2-2*nu)*cosb-(v*cosb+y32a)/(q)*(1+a/v/cosb)))*(1/2/v*(2*y3+4*a)+cosb)+(y3+a)*cotb/(q)*(a/(y12y22y32a2)**(3/2)/cosb*y1-3/2*a*y1*(y32a)/(y12y22y32a2)**(5/2)/cosb*(2*y3+4*a)+1/2/(y12y22y32a2)*sinb*(2*y3+4*a)*((2-2*nu)*cosb-(v*cosb+y32a)/(q)*(1+a/v/cosb))-1/2*(v*sinb-y1)/(y12y22y32a2)**(3/2)*((2-2*nu)*cosb-(v*cosb+y32a)/(q)*(1+a/v/cosb))*(2*y3+4*a)+(v*sinb-y1)/v*(-(1/2/v*cosb*(2*y3+4*a)+1)/(q)*(1+a/v/cosb)+(v*cosb+y32a)/(q)**2*(1+a/v/cosb)*(1/2/v*(2*y3+4*a)+cosb)+1/2*(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)/cosb*(2*y3+4*a))))/pi/(1-nu))+1/2*B3*(1/8*y2*sinb*(1/(y12y22y32)*sinb*y3/(z-y1*sinb-y3*cosb)-(z*sinb-y1)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y3-(z*sinb-y1)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y3-cosb)+1/2/(y12y22y32a2)*sinb*(2*y3+4*a)/(q)-1/2*(v*sinb-y1)/(y12y22y32a2)**(3/2)/(q)*(2*y3+4*a)-(v*sinb-y1)/v/(q)**2*(1/2/v*(2*y3+4*a)+cosb))/pi/(1-nu)+1/4*((1-2*nu)*(-y2/(r)**2*(1+a/v)*(1/2/v*(2*y3+4*a)+1)-1/2*y2/(r)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)+y2*cosb/(q)**2*(cosb+a/v)*(1/2/v*(2*y3+4*a)+cosb)+1/2*y2*cosb/(q)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a))-y2/v*(a/(y12y22y32a2)+1/(r))+1/2*y2*(y3+a)/(y12y22y32a2)**(3/2)*(a/(y12y22y32a2)+1/(r))*(2*y3+4*a)-y2*(y3+a)/v*(-a/(y12y22y32a2)**2*(2*y3+4*a)-1/(r)**2*(1/2/v*(2*y3+4*a)+1))+y2*cosb/v/(q)*((v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))-1/2*y2*(y3+a)*cosb/(y12y22y32a2)**(3/2)/(q)*((v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))*(2*y3+4*a)-y2*(y3+a)*cosb/v/(q)**2*((v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))*(1/2/v*(2*y3+4*a)+cosb)+y2*(y3+a)*cosb/v/(q)*((1/2/v*cosb*(2*y3+4*a)+1)/(q)*(cosb+a/v)-(v*cosb+y32a)/(q)**2*(cosb+a/v)*(1/2/v*(2*y3+4*a)+cosb)-1/2*(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)+a/(y12y22y32a2)-a*(y32a)/(y12y22y32a2)**2*(2*y3+4*a)))/pi/(1-nu))+1/2*B1*(1/8*y2*(-1/(y12y22y32)**(3/2)*y1+1/(y12y22y32a2)**(3/2)*y1-cosb*(1/(y12y22y32)*cosb*y1/(z-y1*sinb-y3*cosb)-(z*cosb-y3)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y1-(z*cosb-y3)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y1-sinb)-1/(y12y22y32a2)*cosb*y1/(q)+(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*y1+(v*cosb+y32a)/v/(q)**2*(1/v*y1-sinb)))/pi/(1-nu)+1/4*((2-2*nu)*((1-2*nu)*(y2/y12/(1+y22/y12)-y2/(y1*cosb+(y32a)*sinb)**2*cosb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*y1-y2*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*(2*y1*cosb+(y32a)*sinb))/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))*cotb-y1/(r)**2*(2*nu+a/v)/v*y2-y2/(r)*a/(y12y22y32a2)**(3/2)*y1+y2*cosb/(q)**2*(cosb+a/v)*(1/v*y1-sinb)+y2*cosb/(q)*a/(y12y22y32a2)**(3/2)*y1)-y2*(y3+a)/(y12y22y32a2)**(3/2)*(2*nu/(r)+a/(y12y22y32a2))*y1+y2*(y3+a)/v*(-2*nu/(r)**2/v*y1-2*a/(y12y22y32a2)**2*y1)-y2*(y3+a)*cosb/(y12y22y32a2)**(3/2)/(q)*(1-2*nu-(v*cosb+y32a)/(q)*(cosb+a/v)-a*(y32a)/(y12y22y32a2))*y1-y2*(y3+a)*cosb/v/(q)**2*(1-2*nu-(v*cosb+y32a)/(q)*(cosb+a/v)-a*(y32a)/(y12y22y32a2))*(1/v*y1-sinb)+y2*(y3+a)*cosb/v/(q)*(-1/v*cosb*y1/(q)*(cosb+a/v)+(v*cosb+y32a)/(q)**2*(cosb+a/v)*(1/v*y1-sinb)+(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)*y1+2*a*(y32a)/(y12y22y32a2)**2*y1))/pi/(1-nu))+1/2*B2*(1/8*((-1+2*nu)*sinb*((1/z*y1-sinb)/(z-y1*sinb-y3*cosb)-(1/v*y1-sinb)/(q))-1/z+1/v-y1*(-1/(y12y22y32)**(3/2)*y1+1/(y12y22y32a2)**(3/2)*y1)+cosb*(z*cosb-y3)/z/(z-y1*sinb-y3*cosb)+(y1*cosb-y3*sinb)/(y12y22y32)*cosb*y1/(z-y1*sinb-y3*cosb)-(y1*cosb-y3*sinb)*(z*cosb-y3)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y1-(y1*cosb-y3*sinb)*(z*cosb-y3)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y1-sinb)-cosb*(v*cosb+y32a)/v/(q)-(y1*cosb+(y32a)*sinb)/(y12y22y32a2)*cosb*y1/(q)+(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*y1+(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/v/(q)**2*(1/v*y1-sinb))/pi/(1-nu)+1/4*((-2+2*nu)*(1-2*nu)*cotb*(1/v*y1/(r)-cosb*(1/v*y1-sinb)/(q))-(2-2*nu)/(r)*(2*nu+a/v)+(2-2*nu)*y12/(r)**2*(2*nu+a/v)/v+(2-2*nu)*y12/(r)*a/(y12y22y32a2)**(3/2)+(2-2*nu)*cosb/(q)*(cosb+a/v)-(2-2*nu)*(y1*cosb+(y32a)*sinb)/(q)**2*(cosb+a/v)*(1/v*y1-sinb)-(2-2*nu)*(y1*cosb+(y32a)*sinb)/(q)*a/(y12y22y32a2)**(3/2)*y1-(y3+a)/(y12y22y32a2)**(3/2)*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/(y12y22y32a2))*y1+(y3+a)/v*(-2*nu/(r)+2*nu*y12/(r)**2/v-a/(y12y22y32a2)+2*a*y12/(y12y22y32a2)**2)+(y3+a)/(q)**2*(cosb*sinb+(v*cosb+y32a)*cotb/v*((2-2*nu)*cosb-(v*cosb+y32a)/(q))+a/v*(sinb-(y32a)*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)-(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/v/(q)))*(1/v*y1-sinb)-(y3+a)/(q)*(1/(y12y22y32a2)*cosb*y1*cotb*((2-2*nu)*cosb-(v*cosb+y32a)/(q))-(v*cosb+y32a)*cotb/(y12y22y32a2)**(3/2)*((2-2*nu)*cosb-(v*cosb+y32a)/(q))*y1+(v*cosb+y32a)*cotb/v*(-1/v*cosb*y1/(q)+(v*cosb+y32a)/(q)**2*(1/v*y1-sinb))-a/(y12y22y32a2)**(3/2)*(sinb-(y32a)*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)-(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/v/(q))*y1+a/v*(-(y32a)*cosb/(y12y22y32a2)+2*(y32a)*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**2*y1-cosb*(v*cosb+y32a)/v/(q)-(y1*cosb+(y32a)*sinb)/(y12y22y32a2)*cosb*y1/(q)+(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*y1+(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/v/(q)**2*(1/v*y1-sinb))))/pi/(1-nu))+1/2*B3*(1/8*((2-2*nu)*(-y2/(y1*cosb-y3*sinb)**2*cosb/(1+y22/(y1*cosb-y3*sinb)**2)+(y2/z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)*y1-y2*z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2*(2*y1*cosb-y3*sinb))/(1+y22*(y12y22y32)*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2)+y2/(y1*cosb+(y32a)*sinb)**2*cosb/(1+y22/(y1*cosb+(y32a)*sinb)**2)-(y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*y1-y2*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*(2*y1*cosb+(y32a)*sinb))/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))+y2*sinb*(1/(y12y22y32)*cosb*y1/(z-y1*sinb-y3*cosb)-(z*cosb-y3)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y1-(z*cosb-y3)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y1-sinb)-1/(y12y22y32a2)*cosb*y1/(q)+(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*y1+(v*cosb+y32a)/v/(q)**2*(1/v*y1-sinb)))/pi/(1-nu)+1/4*((2-2*nu)*(y2/y12/(1+y22/y12)-y2/(y1*cosb+(y32a)*sinb)**2*cosb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*y1-y2*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*(2*y1*cosb+(y32a)*sinb))/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))-(2-2*nu)*y2*sinb/(q)**2*(cosb+a/v)*(1/v*y1-sinb)-(2-2*nu)*y2*sinb/(q)*a/(y12y22y32a2)**(3/2)*y1-y2*(y3+a)*sinb/(y12y22y32a2)**(3/2)/(q)*(1+(v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))*y1-y2*(y3+a)*sinb/v/(q)**2*(1+(v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))*(1/v*y1-sinb)+y2*(y3+a)*sinb/v/(q)*(1/v*cosb*y1/(q)*(cosb+a/v)-(v*cosb+y32a)/(q)**2*(cosb+a/v)*(1/v*y1-sinb)-(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)*y1-2*a*(y32a)/(y12y22y32a2)**2*y1))/pi/(1-nu))
  e23 = 1/2*B1*(1/8*((1-2*nu)*((1/z*y3-1)/(z-y3)+(1/2/v*(2*y3+4*a)+1)/(r)-cosb*((1/z*y3-cosb)/(z-y1*sinb-y3*cosb)+(1/2/v*(2*y3+4*a)+cosb)/(q)))-y22*(-1/(y12y22y32)**(3/2)/(z-y3)*y3-1/z/(z-y3)**2*(1/z*y3-1)-1/2/(y12y22y32a2)**(3/2)/(r)*(2*y3+4*a)-1/v/(r)**2*(1/2/v*(2*y3+4*a)+1)-cosb*(-1/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y3-1/z/(z-y1*sinb-y3*cosb)**2*(1/z*y3-cosb)-1/2/(y12y22y32a2)**(3/2)/(q)*(2*y3+4*a)-1/v/(q)**2*(1/2/v*(2*y3+4*a)+cosb))))/pi/(1-nu)+1/4*((1-2*nu)*(((2-2*nu)*cotb**2-nu)*(1/2/v*(2*y3+4*a)+1)/(r)-((2-2*nu)*cotb**2+1-2*nu)*cosb*(1/2/v*(2*y3+4*a)+cosb)/(q))+(1-2*nu)/(r)**2*(y1*cotb*(1-2*nu-a/v)+nu*(y32a)-a+y22/(r)*(nu+a/v))*(1/2/v*(2*y3+4*a)+1)-(1-2*nu)/(r)*(1/2*a*y1*cotb/(y12y22y32a2)**(3/2)*(2*y3+4*a)+nu-y22/(r)**2*(nu+a/v)*(1/2/v*(2*y3+4*a)+1)-1/2*y22/(r)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a))-(1-2*nu)*sinb*cotb/(q)*(cosb+a/v)+(1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb/(q)**2*(cosb+a/v)*(1/2/v*(2*y3+4*a)+cosb)+1/2*(1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb/(q)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)-a/(y12y22y32a2)**(3/2)*y1*cotb+3/2*a*y1*(y3+a)*cotb/(y12y22y32a2)**(5/2)*(2*y3+4*a)+1/(r)*(-2*nu+1/v*((1-2*nu)*y1*cotb-a)+y22/v/(r)*(2*nu+a/v)+a*y22/(y12y22y32a2)**(3/2))-(y3+a)/(r)**2*(-2*nu+1/v*((1-2*nu)*y1*cotb-a)+y22/v/(r)*(2*nu+a/v)+a*y22/(y12y22y32a2)**(3/2))*(1/2/v*(2*y3+4*a)+1)+(y3+a)/(r)*(-1/2/(y12y22y32a2)**(3/2)*((1-2*nu)*y1*cotb-a)*(2*y3+4*a)-1/2*y22/(y12y22y32a2)**(3/2)/(r)*(2*nu+a/v)*(2*y3+4*a)-y22/v/(r)**2*(2*nu+a/v)*(1/2/v*(2*y3+4*a)+1)-1/2*y22/(y12y22y32a2)**2/(r)*a*(2*y3+4*a)-3/2*a*y22/(y12y22y32a2)**(5/2)*(2*y3+4*a))+1/(q)*(cosb**2-1/v*((1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb+a*cosb)+a*(y32a)*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)**(3/2)-1/v/(q)*(y22*cosb**2-a*(y1*cosb+(y32a)*sinb)*cotb/v*(v*cosb+y32a)))-(y3+a)/(q)**2*(cosb**2-1/v*((1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb+a*cosb)+a*(y32a)*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)**(3/2)-1/v/(q)*(y22*cosb**2-a*(y1*cosb+(y32a)*sinb)*cotb/v*(v*cosb+y32a)))*(1/2/v*(2*y3+4*a)+cosb)+(y3+a)/(q)*(1/2/(y12y22y32a2)**(3/2)*((1-2*nu)*(y1*cosb+(y32a)*sinb)*cotb+a*cosb)*(2*y3+4*a)-1/v*(1-2*nu)*sinb*cotb+a*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)**(3/2)+a*(y32a)*sinb*cotb/(y12y22y32a2)**(3/2)-3/2*a*(y32a)*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)**(5/2)*(2*y3+4*a)+1/2/(y12y22y32a2)**(3/2)/(q)*(y22*cosb**2-a*(y1*cosb+(y32a)*sinb)*cotb/v*(v*cosb+y32a))*(2*y3+4*a)+1/v/(q)**2*(y22*cosb**2-a*(y1*cosb+(y32a)*sinb)*cotb/v*(v*cosb+y32a))*(1/2/v*(2*y3+4*a)+cosb)-1/v/(q)*(-a*sinb*cotb/v*(v*cosb+y32a)+1/2*a*(y1*cosb+(y32a)*sinb)*cotb/(y12y22y32a2)**(3/2)*(v*cosb+y32a)*(2*y3+4*a)-a*(y1*cosb+(y32a)*sinb)*cotb/v*(1/2/v*cosb*(2*y3+4*a)+1))))/pi/(1-nu))+1/2*B2*(1/8*((2-2*nu)*(y2/(y1*cosb-y3*sinb)**2*sinb/(1+y22/(y1*cosb-y3*sinb)**2)+(y2/z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)*y3+y2*z*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2*y1)/(1+y22*(y12y22y32)*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2)-y2/(y1*cosb+(y32a)*sinb)**2*sinb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(1/2*y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*(2*y3+4*a)-y2*v*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*y1)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))+y1*y2*(-1/(y12y22y32)**(3/2)/(z-y3)*y3-1/z/(z-y3)**2*(1/z*y3-1)-1/2/(y12y22y32a2)**(3/2)/(r)*(2*y3+4*a)-1/v/(r)**2*(1/2/v*(2*y3+4*a)+1))-y2*(-sinb/z/(z-y1*sinb-y3*cosb)-(y1*cosb-y3*sinb)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y3-(y1*cosb-y3*sinb)/z/(z-y1*sinb-y3*cosb)**2*(1/z*y3-cosb)+sinb/v/(q)-1/2*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**(3/2)/(q)*(2*y3+4*a)-(y1*cosb+(y32a)*sinb)/v/(q)**2*(1/2/v*(2*y3+4*a)+cosb)))/pi/(1-nu)+1/4*((2-2*nu)*(1-2*nu)*(-y2/(y1*cosb+(y32a)*sinb)**2*sinb/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(1/2*y2/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)*(2*y3+4*a)-y2*v*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*y1)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))*cotb**2-(1-2*nu)*y2/(r)**2*((-1+2*nu+a/v)*cotb+y1/(r)*(nu+a/v))*(1/2/v*(2*y3+4*a)+1)+(1-2*nu)*y2/(r)*(-1/2*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)*cotb-y1/(r)**2*(nu+a/v)*(1/2/v*(2*y3+4*a)+1)-1/2*y1/(r)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a))+(1-2*nu)*y2*cotb/(q)**2*(1+a/v/cosb)*(1/2/v*(2*y3+4*a)+cosb)+1/2*(1-2*nu)*y2*cotb/(q)*a/(y12y22y32a2)**(3/2)/cosb*(2*y3+4*a)-a/(y12y22y32a2)**(3/2)*y2*cotb+3/2*a*y2*(y3+a)*cotb/(y12y22y32a2)**(5/2)*(2*y3+4*a)+y2/v/(r)*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/v*(1/v+1/(r)))-1/2*y2*(y3+a)/(y12y22y32a2)**(3/2)/(r)*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/v*(1/v+1/(r)))*(2*y3+4*a)-y2*(y3+a)/v/(r)**2*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/v*(1/v+1/(r)))*(1/2/v*(2*y3+4*a)+1)+y2*(y3+a)/v/(r)*(2*nu*y1/(r)**2*(1/2/v*(2*y3+4*a)+1)+1/2*a*y1/(y12y22y32a2)**(3/2)*(1/v+1/(r))*(2*y3+4*a)-a*y1/v*(-1/2/(y12y22y32a2)**(3/2)*(2*y3+4*a)-1/(r)**2*(1/2/v*(2*y3+4*a)+1)))+y2*cotb/v/(q)*((-2+2*nu)*cosb+(v*cosb+y32a)/(q)*(1+a/v/cosb)+a*(y32a)/(y12y22y32a2)/cosb)-1/2*y2*(y3+a)*cotb/(y12y22y32a2)**(3/2)/(q)*((-2+2*nu)*cosb+(v*cosb+y32a)/(q)*(1+a/v/cosb)+a*(y32a)/(y12y22y32a2)/cosb)*(2*y3+4*a)-y2*(y3+a)*cotb/v/(q)**2*((-2+2*nu)*cosb+(v*cosb+y32a)/(q)*(1+a/v/cosb)+a*(y32a)/(y12y22y32a2)/cosb)*(1/2/v*(2*y3+4*a)+cosb)+y2*(y3+a)*cotb/v/(q)*((1/2/v*cosb*(2*y3+4*a)+1)/(q)*(1+a/v/cosb)-(v*cosb+y32a)/(q)**2*(1+a/v/cosb)*(1/2/v*(2*y3+4*a)+cosb)-1/2*(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)/cosb*(2*y3+4*a)+a/(y12y22y32a2)/cosb-a*(y32a)/(y12y22y32a2)**2/cosb*(2*y3+4*a)))/pi/(1-nu))+1/2*B3*(1/8*((1-2*nu)*sinb*((1/z*y3-cosb)/(z-y1*sinb-y3*cosb)+(1/2/v*(2*y3+4*a)+cosb)/(q))-y22*sinb*(-1/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y3-1/z/(z-y1*sinb-y3*cosb)**2*(1/z*y3-cosb)-1/2/(y12y22y32a2)**(3/2)/(q)*(2*y3+4*a)-1/v/(q)**2*(1/2/v*(2*y3+4*a)+cosb)))/pi/(1-nu)+1/4*((1-2*nu)*(-sinb*(1/2/v*(2*y3+4*a)+cosb)/(q)+y1/(r)**2*(1+a/v)*(1/2/v*(2*y3+4*a)+1)+1/2*y1/(r)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)+sinb/(q)*(cosb+a/v)-(y1*cosb+(y32a)*sinb)/(q)**2*(cosb+a/v)*(1/2/v*(2*y3+4*a)+cosb)-1/2*(y1*cosb+(y32a)*sinb)/(q)*a/(y12y22y32a2)**(3/2)*(2*y3+4*a))+y1/v*(a/(y12y22y32a2)+1/(r))-1/2*y1*(y3+a)/(y12y22y32a2)**(3/2)*(a/(y12y22y32a2)+1/(r))*(2*y3+4*a)+y1*(y3+a)/v*(-a/(y12y22y32a2)**2*(2*y3+4*a)-1/(r)**2*(1/2/v*(2*y3+4*a)+1))-1/(q)*(sinb*(cosb-a/v)+(y1*cosb+(y32a)*sinb)/v*(1+a*(y32a)/(y12y22y32a2))-1/v/(q)*(y22*cosb*sinb-a*(y1*cosb+(y32a)*sinb)/v*(v*cosb+y32a)))+(y3+a)/(q)**2*(sinb*(cosb-a/v)+(y1*cosb+(y32a)*sinb)/v*(1+a*(y32a)/(y12y22y32a2))-1/v/(q)*(y22*cosb*sinb-a*(y1*cosb+(y32a)*sinb)/v*(v*cosb+y32a)))*(1/2/v*(2*y3+4*a)+cosb)-(y3+a)/(q)*(1/2*sinb*a/(y12y22y32a2)**(3/2)*(2*y3+4*a)+sinb/v*(1+a*(y32a)/(y12y22y32a2))-1/2*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**(3/2)*(1+a*(y32a)/(y12y22y32a2))*(2*y3+4*a)+(y1*cosb+(y32a)*sinb)/v*(a/(y12y22y32a2)-a*(y32a)/(y12y22y32a2)**2*(2*y3+4*a))+1/2/(y12y22y32a2)**(3/2)/(q)*(y22*cosb*sinb-a*(y1*cosb+(y32a)*sinb)/v*(v*cosb+y32a))*(2*y3+4*a)+1/v/(q)**2*(y22*cosb*sinb-a*(y1*cosb+(y32a)*sinb)/v*(v*cosb+y32a))*(1/2/v*(2*y3+4*a)+cosb)-1/v/(q)*(-a*sinb/v*(v*cosb+y32a)+1/2*a*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**(3/2)*(v*cosb+y32a)*(2*y3+4*a)-a*(y1*cosb+(y32a)*sinb)/v*(1/2/v*cosb*(2*y3+4*a)+1))))/pi/(1-nu))+1/2*B1*(1/8*(1/z-1/v-cosb*((z*cosb-y3)/z/(z-y1*sinb-y3*cosb)-(v*cosb+y32a)/v/(q)))/pi/(1-nu)+1/8*y2*(-1/(y12y22y32)**(3/2)*y2+1/(y12y22y32a2)**(3/2)*y2-cosb*(1/(y12y22y32)*cosb*y2/(z-y1*sinb-y3*cosb)-(z*cosb-y3)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y2-(z*cosb-y3)/(y12y22y32)/(z-y1*sinb-y3*cosb)**2*y2-1/(y12y22y32a2)*cosb*y2/(q)+(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*y2+(v*cosb+y32a)/(y12y22y32a2)/(q)**2*y2))/pi/(1-nu)+1/4*((2-2*nu)*((1-2*nu)*(-1/y1/(1+y22/y12)+1/(y1*cosb+(y32a)*sinb)/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)+y22/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)-2*y22*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*cosb)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))*cotb+1/(r)*(2*nu+a/v)-y22/(r)**2*(2*nu+a/v)/v-y22/(r)*a/(y12y22y32a2)**(3/2)-cosb/(q)*(cosb+a/v)+y22*cosb/(q)**2*(cosb+a/v)/v+y22*cosb/(q)*a/(y12y22y32a2)**(3/2))+(y3+a)/v*(2*nu/(r)+a/(y12y22y32a2))-y22*(y3+a)/(y12y22y32a2)**(3/2)*(2*nu/(r)+a/(y12y22y32a2))+y2*(y3+a)/v*(-2*nu/(r)**2/v*y2-2*a/(y12y22y32a2)**2*y2)+(y3+a)*cosb/v/(q)*(1-2*nu-(v*cosb+y32a)/(q)*(cosb+a/v)-a*(y32a)/(y12y22y32a2))-y22*(y3+a)*cosb/(y12y22y32a2)**(3/2)/(q)*(1-2*nu-(v*cosb+y32a)/(q)*(cosb+a/v)-a*(y32a)/(y12y22y32a2))-y22*(y3+a)*cosb/(y12y22y32a2)/(q)**2*(1-2*nu-(v*cosb+y32a)/(q)*(cosb+a/v)-a*(y32a)/(y12y22y32a2))+y2*(y3+a)*cosb/v/(q)*(-1/v*cosb*y2/(q)*(cosb+a/v)+(v*cosb+y32a)/(q)**2*(cosb+a/v)/v*y2+(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)*y2+2*a*(y32a)/(y12y22y32a2)**2*y2))/pi/(1-nu))+1/2*B2*(1/8*((-1+2*nu)*sinb*(1/z*y2/(z-y1*sinb-y3*cosb)-1/v*y2/(q))-y1*(-1/(y12y22y32)**(3/2)*y2+1/(y12y22y32a2)**(3/2)*y2)+(y1*cosb-y3*sinb)/(y12y22y32)*cosb*y2/(z-y1*sinb-y3*cosb)-(y1*cosb-y3*sinb)*(z*cosb-y3)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y2-(y1*cosb-y3*sinb)*(z*cosb-y3)/(y12y22y32)/(z-y1*sinb-y3*cosb)**2*y2-(y1*cosb+(y32a)*sinb)/(y12y22y32a2)*cosb*y2/(q)+(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*y2+(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/(y12y22y32a2)/(q)**2*y2)/pi/(1-nu)+1/4*((-2+2*nu)*(1-2*nu)*cotb*(1/v*y2/(r)-cosb/v*y2/(q))+(2-2*nu)*y1/(r)**2*(2*nu+a/v)/v*y2+(2-2*nu)*y1/(r)*a/(y12y22y32a2)**(3/2)*y2-(2-2*nu)*(y1*cosb+(y32a)*sinb)/(q)**2*(cosb+a/v)/v*y2-(2-2*nu)*(y1*cosb+(y32a)*sinb)/(q)*a/(y12y22y32a2)**(3/2)*y2-(y3+a)/(y12y22y32a2)**(3/2)*((1-2*nu)*cotb-2*nu*y1/(r)-a*y1/(y12y22y32a2))*y2+(y3+a)/v*(2*nu*y1/(r)**2/v*y2+2*a*y1/(y12y22y32a2)**2*y2)+(y3+a)/(q)**2*(cosb*sinb+(v*cosb+y32a)*cotb/v*((2-2*nu)*cosb-(v*cosb+y32a)/(q))+a/v*(sinb-(y32a)*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)-(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/v/(q)))/v*y2-(y3+a)/(q)*(1/(y12y22y32a2)*cosb*y2*cotb*((2-2*nu)*cosb-(v*cosb+y32a)/(q))-(v*cosb+y32a)*cotb/(y12y22y32a2)**(3/2)*((2-2*nu)*cosb-(v*cosb+y32a)/(q))*y2+(v*cosb+y32a)*cotb/v*(-cosb/v*y2/(q)+(v*cosb+y32a)/(q)**2/v*y2)-a/(y12y22y32a2)**(3/2)*(sinb-(y32a)*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)-(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/v/(q))*y2+a/v*(2*(y32a)*(y1*cosb+(y32a)*sinb)/(y12y22y32a2)**2*y2-(y1*cosb+(y32a)*sinb)/(y12y22y32a2)*cosb*y2/(q)+(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*y2+(y1*cosb+(y32a)*sinb)*(v*cosb+y32a)/(y12y22y32a2)/(q)**2*y2)))/pi/(1-nu))+1/2*B3*(1/8*((2-2*nu)*(1/(y1*cosb-y3*sinb)/(1+y22/(y1*cosb-y3*sinb)**2)+(z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)+y22/z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)-2*y22*z*sinb/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2*cosb)/(1+y22*(y12y22y32)*sinb**2/(y1*(y1*cosb-y3*sinb)+y22*cosb)**2)-1/(y1*cosb+(y32a)*sinb)/(1+y22/(y1*cosb+(y32a)*sinb)**2)-(v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)+y22/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)-2*y22*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*cosb)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))+sinb*((z*cosb-y3)/z/(z-y1*sinb-y3*cosb)-(v*cosb+y32a)/v/(q))+y2*sinb*(1/(y12y22y32)*cosb*y2/(z-y1*sinb-y3*cosb)-(z*cosb-y3)/(y12y22y32)**(3/2)/(z-y1*sinb-y3*cosb)*y2-(z*cosb-y3)/(y12y22y32)/(z-y1*sinb-y3*cosb)**2*y2-1/(y12y22y32a2)*cosb*y2/(q)+(v*cosb+y32a)/(y12y22y32a2)**(3/2)/(q)*y2+(v*cosb+y32a)/(y12y22y32a2)/(q)**2*y2))/pi/(1-nu)+1/4*((2-2*nu)*(-1/y1/(1+y22/y12)+1/(y1*cosb+(y32a)*sinb)/(1+y22/(y1*cosb+(y32a)*sinb)**2)+(v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)+y22/v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)-2*y22*v*sinb/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2*cosb)/(1+y22*(y12y22y32a2)*sinb**2/(y1*(y1*cosb+(y32a)*sinb)+y22*cosb)**2))+(2-2*nu)*sinb/(q)*(cosb+a/v)-(2-2*nu)*y22*sinb/(q)**2*(cosb+a/v)/v-(2-2*nu)*y22*sinb/(q)*a/(y12y22y32a2)**(3/2)+(y3+a)*sinb/v/(q)*(1+(v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))-y22*(y3+a)*sinb/(y12y22y32a2)**(3/2)/(q)*(1+(v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))-y22*(y3+a)*sinb/(y12y22y32a2)/(q)**2*(1+(v*cosb+y32a)/(q)*(cosb+a/v)+a*(y32a)/(y12y22y32a2))+y2*(y3+a)*sinb/v/(q)*(1/v*cosb*y2/(q)*(cosb+a/v)-(v*cosb+y32a)/(q)**2*(cosb+a/v)/v*y2-(v*cosb+y32a)/(q)*a/(y12y22y32a2)**(3/2)*y2-2*a*(y32a)/(y12y22y32a2)**2*y2))/pi/(1-nu))
  return e11,e22,e33,e12,e13,e23

